<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>KPay API Documentation</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <style>
      body {
        font-family: "Inter", sans-serif;
        background-color: #0a0a0a;
        color: #e5e7eb;
      }
      .glass-effect {
        background: rgba(255, 255, 255, 0.05);
        backdrop-filter: blur(10px);
        -webkit-backdrop-filter: blur(10px);
        border: 1px solid rgba(255, 255, 255, 0.1);
      }
      .sidebar-item:hover,
      .sidebar-item.active {
        background: rgba(255, 255, 255, 0.1);
        transform: translateX(5px);
        transition: all 0.3s ease;
      }
      .code-block {
        background-color: #1e1e1e;
        color: #d4d4d4;
        padding: 1.5rem;
        border-radius: 0.5rem;
        border: 1px solid rgba(255, 255, 255, 0.1);
        position: relative;
      }
      .code-block pre {
        white-space: pre-wrap;
        word-wrap: break-word;
      }
      .copy-btn {
        position: absolute;
        top: 1rem;
        right: 1rem;
        background: rgba(255, 255, 255, 0.1);
        color: #e5e7eb;
        border: none;
        padding: 0.5rem;
        border-radius: 0.25rem;
        cursor: pointer;
        transition: all 0.3s ease;
      }
      .copy-btn:hover {
        background: rgba(255, 255, 255, 0.2);
      }
      .section-title {
        border-bottom: 2px solid rgba(255, 255, 255, 0.1);
        padding-bottom: 0.5rem;
        margin-bottom: 1.5rem;
      }
      .table-glass {
        background: rgba(17, 24, 39, 0.5); /* bg-gray-900/50 */
        border-radius: 0.75rem;
        overflow: hidden;
        border: 1px solid rgba(255, 255, 255, 0.1);
      }
      th,
      td {
        padding: 1rem 1.5rem;
        text-align: left;
      }
      thead {
        background: rgba(255, 255, 255, 0.05);
      }
      tbody tr:not(:last-child) {
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      }
      .fade-in {
        animation: fadeIn 1s ease-in-out;
      }
      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(20px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }
    </style>
  </head>
  <body class="bg-gray-900 text-gray-200">
    <div class="flex min-h-screen">
      <!-- Sidebar -->
      <aside
        class="w-64 fixed top-0 left-0 h-full p-4 glass-effect z-10 hidden lg:block"
      >
        <div class="text-2xl font-bold mb-8 text-white">KPay API Docs</div>
        <nav class="space-y-2">
          <a
            href="#get-started"
            class="sidebar-item block p-2 rounded-lg transition-all duration-300"
            >Get Started</a
          >
          <a
            href="#authentication"
            class="sidebar-item block p-2 rounded-lg transition-all duration-300"
            >Authentication</a
          >
          <a
            href="#payment-methods"
            class="sidebar-item block p-2 rounded-lg transition-all duration-300"
            >Supported Methods</a
          >
          <a
            href="#payment-request"
            class="sidebar-item block p-2 rounded-lg transition-all duration-300"
            >Payment Request</a
          >
          <a
            href="#postback"
            class="sidebar-item block p-2 rounded-lg transition-all duration-300"
            >Async Postback</a
          >
          <a
            href="#check-status"
            class="sidebar-item block p-2 rounded-lg transition-all duration-300"
            >Check Status</a
          >
          <a
            href="#error-codes"
            class="sidebar-item block p-2 rounded-lg transition-all duration-300"
            >Error Codes</a
          >
          <a
            href="#bank-codes"
            class="sidebar-item block p-2 rounded-lg transition-all duration-300"
            >Bank Codes</a
          >
          <a
            href="#test-cards"
            class="sidebar-item block p-2 rounded-lg transition-all duration-300"
            >Test Cards</a
          >
        </nav>
      </aside>

      <!-- Main Content -->
      <main class="lg:ml-64 flex-1 p-6 md:p-10 space-y-12">
        <!-- Get Started -->
        <section id="get-started" class="fade-in">
          <h2 class="section-title text-3xl font-bold text-white">
            Get Started
          </h2>
          <p class="text-gray-400 mb-6">
            Welcome to the KPay API. This guide will help you integrate KPay
            into your application for seamless payments.
          </p>
          <div class="table-glass">
            <table class="w-full">
              <thead>
                <tr>
                  <th class="font-semibold text-white">Item</th>
                  <th class="font-semibold text-white">Value</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>Live Endpoint</td>
                  <td><code>pay.esicia.rw</code></td>
                </tr>
                <tr>
                  <td>Sandbox Endpoint</td>
                  <td><code>pay.esicia.com</code></td>
                </tr>
                <tr>
                  <td>Port</td>
                  <td><code>443</code></td>
                </tr>
                <tr>
                  <td>Protocol</td>
                  <td><code>HTTPS</code></td>
                </tr>
              </tbody>
            </table>
          </div>
        </section>

        <!-- Authentication -->
        <section id="authentication" class="fade-in">
          <h2 class="section-title text-3xl font-bold text-white">
            Authentication
          </h2>
          <p class="text-gray-400 mb-6">
            API access is granted using Basic Authentication over HTTPS. You
            must also provide a list of whitelisted IPs from which your
            application will send requests.
          </p>
          <div class="code-block">
            <button class="copy-btn" onclick="copyCode(this)">Copy</button>
            <pre><code class="language-bash"># cURL Example
curl --user "your_username:your_password" https://pay.esicia.com/api/</code></pre>
          </div>
        </section>

        <!-- Supported Payment Methods -->
        <section id="payment-methods" class="fade-in">
          <h2 class="section-title text-3xl font-bold text-white">
            Supported Payment Methods
          </h2>
          <p class="text-gray-400 mb-6">
            The KPay API supports a variety of payment methods to cater to your
            customers' needs.
          </p>
          <div class="grid grid-cols-2 md:grid-cols-3 gap-4">
            <div class="glass-effect p-4 rounded-lg text-center">
              MTN Mobile Money
            </div>
            <div class="glass-effect p-4 rounded-lg text-center">
              Airtel Money
            </div>
            <div class="glass-effect p-4 rounded-lg text-center">Visa</div>
            <div class="glass-effect p-4 rounded-lg text-center">
              MasterCard
            </div>
            <div class="glass-effect p-4 rounded-lg text-center">SPENN</div>
            <div class="glass-effect p-4 rounded-lg text-center">SmartCash</div>
          </div>
        </section>

        <!-- Payment Request -->
        <section id="payment-request" class="fade-in">
          <h2 class="section-title text-3xl font-bold text-white">
            Payment Request
          </h2>
          <p class="text-gray-400 mb-6">
            To initiate a payment, send a POST request with a JSON body to our
            endpoint. Below are the required and optional parameters.
          </p>

          <h3 class="text-xl font-semibold mb-4 text-white">Parameters</h3>
          <div class="table-glass mb-8">
            <table class="w-full">
              <thead>
                <tr>
                  <th>Parameter</th>
                  <th>Severity</th>
                  <th>Type</th>
                  <th>Description</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>action</td>
                  <td>Required</td>
                  <td>string</td>
                  <td>'pay' or 'checkstatus'</td>
                </tr>
                <tr>
                  <td>msisdn</td>
                  <td>Required</td>
                  <td>string</td>
                  <td>Mobile number (e.g., 25078xxxxxxx)</td>
                </tr>
                <tr>
                  <td>email</td>
                  <td>Required</td>
                  <td>string</td>
                  <td>Customer's email address.</td>
                </tr>
                <tr>
                  <td>details</td>
                  <td>Required</td>
                  <td>string</td>
                  <td>Payment details/description.</td>
                </tr>
                <tr>
                  <td>refid</td>
                  <td>Required</td>
                  <td>string</td>
                  <td>Unique payment reference from your system.</td>
                </tr>
                <tr>
                  <td>amount</td>
                  <td>Required</td>
                  <td>integer</td>
                  <td>Payment amount in RWF.</td>
                </tr>
                <tr>
                  <td>currency</td>
                  <td>Optional</td>
                  <td>string</td>
                  <td>'RWF' or 'USD'. Defaults to 'RWF'.</td>
                </tr>
                <tr>
                  <td>cname</td>
                  <td>Required</td>
                  <td>string</td>
                  <td>Name of the person paying.</td>
                </tr>
                <tr>
                  <td>cnumber</td>
                  <td>Required</td>
                  <td>string</td>
                  <td>Customer number at the payment processor.</td>
                </tr>
                <tr>
                  <td>pmethod</td>
                  <td>Required</td>
                  <td>string</td>
                  <td>'cc', 'momo', 'bank', 'spenn', 'smartcash'.</td>
                </tr>
                <tr>
                  <td>retailerid</td>
                  <td>Required</td>
                  <td>string</td>
                  <td>Your unique retailer ID.</td>
                </tr>
                <tr>
                  <td>returl</td>
                  <td>Required</td>
                  <td>string</td>
                  <td>Postback URL for async response (webhook).</td>
                </tr>
                <tr>
                  <td>redirecturl</td>
                  <td>Required</td>
                  <td>string</td>
                  <td>URL for redirection after payment.</td>
                </tr>
                <tr>
                  <td>bankid</td>
                  <td>Required</td>
                  <td>string</td>
                  <td>Financial institution ID (see Bank Codes).</td>
                </tr>
                <tr>
                  <td>logourl</td>
                  <td>Optional</td>
                  <td>string</td>
                  <td>URL to your logo for the checkout page.</td>
                </tr>
              </tbody>
            </table>
          </div>

          <h3 class="text-xl font-semibold mb-4 text-white">
            Request Body Example
          </h3>
          <div class="code-block mb-8">
            <button class="copy-btn" onclick="copyCode(this)">Copy</button>
            <pre><code class="language-json">{
    "msisdn": "0783300000",
    "details": "Order #123",
    "refid": "15947234071471114",
    "amount": 4200,
    "currency": "RWF",
    "email": "customer@example.com",
    "cname": "John Doe",
    "cnumber": "123456789",
    "pmethod": "momo",
    "retailerid": "02",
    "returl": "https://yourdomain.com/api/paymentack",
    "redirecturl": "https://yourdomain.com/payment-success",
    "bankid": "63510"
}</code></pre>
          </div>

          <h3 class="text-xl font-semibold mb-4 text-white">
            Successful Response (Pending)
          </h3>
          <div class="code-block">
            <button class="copy-btn" onclick="copyCode(this)">Copy</button>
            <pre><code class="language-json">{
    "reply": "PENDING",
    "url": "https://pay.esicia.com/checkout/A12343983489",
    "success": 1,
    "authkey": "m43snbf9oivnmersqh6mnllbh5",
    "tid": "E6974831594723691",
    "refid": "15947234071471114",
    "retcode": 0
}</code></pre>
          </div>
        </section>

        <!-- Asynchronous Postback -->
        <section id="postback" class="fade-in">
          <h2 class="section-title text-3xl font-bold text-white">
            Asynchronous Postback
          </h2>
          <p class="text-gray-400 mb-6">
            Once a payment is completed, KPay will send an asynchronous POST
            request to the <code>returl</code> you provided. Your listener
            should expect the following data format and respond with a
            confirmation.
          </p>

          <h3 class="text-xl font-semibold mb-4 text-white">
            Successful Mobile Money Payment
          </h3>
          <div class="code-block mb-8">
            <button class="copy-btn" onclick="copyCode(this)">Copy</button>
            <pre><code class="language-json">{
    "tid": "A441489693051",
    "refid": "1489693046",
    "momtransactionid": "616730887",
    "payaccount": "0783300000",
    "statusid": "01",
    "statusdesc": "Successfully processed transaction."
}</code></pre>
          </div>

          <h3 class="text-xl font-semibold mb-4 text-white">
            Expected Response from Your Server
          </h3>
          <div class="code-block">
            <button class="copy-btn" onclick="copyCode(this)">Copy</button>
            <pre><code class="language-json">{
    "tid": "A441489693051",
    "refid": "1489693046",
    "reply": "OK"
}</code></pre>
          </div>
        </section>

        <!-- Check Status -->
        <section id="check-status" class="fade-in">
          <h2 class="section-title text-3xl font-bold text-white">
            Check Transaction Status
          </h2>
          <p class="text-gray-400 mb-6">
            You can check the status of any transaction by sending a request
            with the transaction's <code>tid</code> or your <code>refid</code>.
            We recommend relying on this method over the postback for
            confirmation.
          </p>

          <h3 class="text-xl font-semibold mb-4 text-white">Request Body</h3>
          <div class="code-block mb-8">
            <button class="copy-btn" onclick="copyCode(this)">Copy</button>
            <pre><code class="language-json">{
    "tid": "A441489693051",
    "refid": "1489693046",
    "action": "checkstatus"
}</code></pre>
          </div>

          <h3 class="text-xl font-semibold mb-4 text-white">
            Response (Transaction Not Found)
          </h3>
          <div class="code-block">
            <button class="copy-btn" onclick="copyCode(this)">Copy</button>
            <pre><code class="language-json">{
    "tid": "",
    "refid": "",
    "momtransactionid": "",
    "statusid": "611",
    "statusdesc": "Transaction not found"
}</code></pre>
          </div>
        </section>

        <!-- Error Codes -->
        <section id="error-codes" class="fade-in">
          <h2 class="section-title text-3xl font-bold text-white">
            KPay Error Codes
          </h2>
          <p class="text-gray-400 mb-6">
            These codes represent the status in the
            <code>retcode</code> (payment request) and
            <code>statusid</code> (postback) fields.
          </p>
          <div class="table-glass">
            <table class="w-full">
              <thead>
                <tr>
                  <th>ID</th>
                  <th>Description</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>0</td>
                  <td>No error. Transaction being processed.</td>
                </tr>
                <tr>
                  <td>01</td>
                  <td>Successful payment.</td>
                </tr>
                <tr>
                  <td>02</td>
                  <td>Payment failed.</td>
                </tr>
                <tr>
                  <td>03</td>
                  <td>Pending transaction.</td>
                </tr>
                <tr>
                  <td>401</td>
                  <td>Missing authentication header.</td>
                </tr>
                <tr>
                  <td>500</td>
                  <td>Non HTTPS request.</td>
                </tr>
                <tr>
                  <td>600</td>
                  <td>Invalid username / password combination.</td>
                </tr>
                <tr>
                  <td>602</td>
                  <td>Location / IP not whitelisted.</td>
                </tr>
                <tr>
                  <td>603</td>
                  <td>Missing required parameters.</td>
                </tr>
                <tr>
                  <td>608</td>
                  <td>Duplicate refid used.</td>
                </tr>
                <tr>
                  <td>611</td>
                  <td>Transaction not found.</td>
                </tr>
              </tbody>
            </table>
          </div>
        </section>

        <!-- Bank Codes -->
        <section id="bank-codes" class="fade-in">
          <h2 class="section-title text-3xl font-bold text-white">
            Bank & Institution Codes
          </h2>
          <p class="text-gray-400 mb-6">
            Use these codes for the <code>bankid</code> parameter in your
            payment requests.
          </p>
          <div class="table-glass">
            <table class="w-full">
              <thead>
                <tr>
                  <th>Bank ID</th>
                  <th>Bank Name</th>
                  <th>Short Name</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>040</td>
                  <td>BANQUE DE KIGALI</td>
                  <td>BK</td>
                </tr>
                <tr>
                  <td>130</td>
                  <td>COMPAGNIE GENERALE DE BANQUES</td>
                  <td>COGEBANQUE</td>
                </tr>
                <tr>
                  <td>63510</td>
                  <td>MTN MOBILE MONEY</td>
                  <td>MTN MOMO</td>
                </tr>
                <tr>
                  <td>63514</td>
                  <td>AIRTEL MONEY</td>
                  <td>AIRTEL MONEY</td>
                </tr>
                <tr>
                  <td>000</td>
                  <td>VISA / MASTERCARD</td>
                  <td>CARDS</td>
                </tr>
                <tr>
                  <td>63502</td>
                  <td>SPENN</td>
                  <td>SPENN</td>
                </tr>
              </tbody>
            </table>
          </div>
        </section>

        <!-- Test Cards -->
        <section id="test-cards" class="fade-in">
          <h2 class="section-title text-3xl font-bold text-white">
            Test Cards
          </h2>
          <p class="text-gray-400 mb-6">
            Use these card numbers for testing in the sandbox environment.
          </p>
          <div class="grid md:grid-cols-2 gap-8">
            <div>
              <h3 class="text-xl font-semibold mb-4 text-white">Mastercard</h3>
              <div class="table-glass">
                <table class="w-full">
                  <thead>
                    <tr>
                      <th>Card Number</th>
                      <th>Type</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>5101 1800 0000 0007</td>
                      <td>Commercial Credit</td>
                    </tr>
                    <tr>
                      <td>5555 4444 3333 1111</td>
                      <td>Consumer</td>
                    </tr>
                    <tr>
                      <td>2222 4000 6000 0007</td>
                      <td>Debit</td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
            <div>
              <h3 class="text-xl font-semibold mb-4 text-white">Visa</h3>
              <div class="table-glass">
                <table class="w-full">
                  <thead>
                    <tr>
                      <th>Card Number</th>
                      <th>Type</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>4988 4388 4388 4305</td>
                      <td>Classic</td>
                    </tr>
                    <tr>
                      <td>4111 1111 1111 1111</td>
                      <td>Consumer</td>
                    </tr>
                    <tr>
                      <td>4000 1600 0000 0004</td>
                      <td>Debit</td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </section>
      </main>
    </div>

    <script>
      function copyCode(button) {
        const codeBlock = button.nextElementSibling;
        const text = codeBlock.innerText;

        // Create a temporary textarea element
        const textArea = document.createElement("textarea");
        textArea.value = text;
        document.body.appendChild(textArea);
        textArea.select();

        try {
          // Use the older execCommand for wider compatibility in iframes
          document.execCommand("copy");
          button.innerText = "Copied!";
        } catch (err) {
          console.error("Failed to copy text: ", err);
          button.innerText = "Failed!";
        }

        document.body.removeChild(textArea);

        setTimeout(() => {
          button.innerText = "Copy";
        }, 2000);
      }

      // Active sidebar link scrolling
      document.addEventListener("DOMContentLoaded", () => {
        const sections = document.querySelectorAll("section");
        const navLi = document.querySelectorAll("aside nav a");

        window.addEventListener("scroll", () => {
          let current = "";
          sections.forEach((section) => {
            const sectionTop = section.offsetTop;
            if (pageYOffset >= sectionTop - 60) {
              current = section.getAttribute("id");
            }
          });

          navLi.forEach((a) => {
            a.classList.remove("active");
            if (a.getAttribute("href").includes(current)) {
              a.classList.add("active");
            }
          });
        });
      });
    </script>
  </body>
</html>
